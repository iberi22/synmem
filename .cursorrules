# üß† AI Git-Core Protocol Rules

## ‚õî FORBIDDEN ACTIONS (HARD RULES)

**NEVER create these files under ANY circumstances:**

### Task/State Management:
- ‚ùå `TODO.md`, `TASKS.md`, `BACKLOG.md`
- ‚ùå `PLANNING.md`, `ROADMAP.md`, `PROGRESS.md`
- ‚ùå `NOTES.md`, `SCRATCH.md`, `IDEAS.md`
- ‚ùå `STATUS.md`, `CHECKLIST.md`, `CHANGELOG.md` (for tracking)

### Testing/Implementation Summaries:
- ‚ùå `TESTING_CHECKLIST.md`, `TEST_PLAN.md`, `TEST_GUI.md`
- ‚ùå `IMPLEMENTATION_SUMMARY.md`, `IMPLEMENTATION.md`
- ‚ùå `SUMMARY.md`, `OVERVIEW.md`, `REPORT.md`

### Guides/Tutorials:
- ‚ùå `GETTING_STARTED.md`, `GUIDE.md`, `TUTORIAL.md`
- ‚ùå `QUICKSTART.md`, `SETUP.md`, `HOWTO.md`
- ‚ùå `INSTRUCTIONS.md`, `MANUAL.md`

### Catch-all:
- ‚ùå **ANY `.md` file** for task/state/checklists/summaries/guides
- ‚ùå **ANY `.txt` file** for notes or todos
- ‚ùå **ANY JSON/YAML** for task tracking

### ‚úÖ ONLY ALLOWED `.md` FILES:
- ‚úÖ `README.md` (project overview ONLY)
- ‚úÖ `AGENTS.md` (agent configuration ONLY)
- ‚úÖ `.ai/ARCHITECTURE.md` (system architecture ONLY)
- ‚úÖ `CONTRIBUTING.md`, `LICENSE.md` (standard repo files)
- ‚úÖ `docs/agent-docs/*.md` (**ONLY when user explicitly requests**)

**üö® BEFORE creating ANY document, STOP and ask:**
> "Can this be a GitHub Issue?" ‚Üí **YES. Create an issue.**
> "Can this be a comment in an existing issue?" ‚Üí **YES. Add a comment.**
> "Is this a summary/checklist/guide?" ‚Üí **NO. Use GitHub Issues or comments.**

---

## 0. Prime Directive (Token Economy)
- **DO NOT use internal memory** to track tasks.
- **DO NOT create files** to document state or progress.
- Your state is **GitHub Issues**.

## 1. Workflow (The Loop)
When starting any task, follow these steps strictly:

1.  **READ (Context):**
    - Read `.ai/ARCHITECTURE.md` to understand the system.
    - Run: `gh issue list --assignee "@me"` to see your current task.
    - If no task assigned, check backlog: `gh issue list --limit 5`.

2.  **ACT (Development):**
    - If taking a new task: `gh issue edit <id> --add-assignee "@me"`.
    - Create a branch: `git checkout -b feat/issue-<id>`.
    - Write code and tests.

3.  **UPDATE (Close):**
    - Commit with Conventional Commits: `feat: description (closes #<id>)`.
    - Push and PR: `gh pr create --fill`.
    - **IMPORTANT:** Do NOT update any text file to mark "check". Git does it for you.

## 2. Planning
- If asked to plan, DO NOT write a long document.
- Generate commands to create issues:
  `gh issue create --title "..." --body "..."`

## 3. Communication
- Be concise
- Always reference issue number: #123
- Use Conventional Commits: feat, fix, docs, chore, refactor, test

## 4. Anti-Patterns (NEVER do this)
- ‚ùå Create task files (TODO.md, TASKS.md, BACKLOG.md)
- ‚ùå Create planning files (PLANNING.md, ROADMAP.md)
- ‚ùå Create progress files (PROGRESS.md, STATUS.md)
- ‚ùå Create notes files (NOTES.md, IDEAS.md, SCRATCH.md)
- ‚ùå Create testing/summary files (TESTING_CHECKLIST.md, IMPLEMENTATION_SUMMARY.md)
- ‚ùå Create guide files (GETTING_STARTED.md, GUIDE.md, TUTORIAL.md)
- ‚ùå Store state in memory or local files
- ‚ùå Write long planning documents
- ‚ùå Forget to reference issues in commits
- ‚ùå Manually close issues (use "closes #X" in commits)
- ‚ùå Create ANY .md that isn't code or real technical documentation

## 5. What you CAN create

- ‚úÖ Source code (.py, .js, .ts, etc.)
- ‚úÖ Tests (in tests/ folder)
- ‚úÖ Technical config (docker, CI/CD, linters)
- ‚úÖ `.ai/ARCHITECTURE.md` (ONLY this file for architecture)
- ‚úÖ `README.md` (project documentation)
- ‚úÖ `docs/agent-docs/*.md` (**ONLY when user explicitly requests**)
- ‚úÖ GitHub Issues for EVERYTHING ELSE

## 6. User-Requested Documents (agent-docs)

When user **EXPLICITLY** requests a persistent document:

```bash
# Create in docs/agent-docs/ with prefix:
# PROMPT_, RESEARCH_, STRATEGY_, ANALYSIS_, SPEC_, GUIDE_, REPORT_

docs/agent-docs/PROMPT_JULES_AUTH_SYSTEM.md
```

**‚úÖ Create file ONLY when user says:**

- "Save this as a document"
- "Create a prompt file for..."
- "Document this strategy"
- "Write a spec for..."

**‚ùå DO NOT create files, just respond in chat:**

- "Explain how to..."
- "Summarize this..."
- "What's the best approach..."

## 7. YAML Frontmatter Meta Tags (REQUIRED)

When creating `docs/agent-docs/*.md`, **ALWAYS** include YAML frontmatter:

```yaml
---
title: "Document Title"
type: PROMPT | RESEARCH | STRATEGY | SPEC | GUIDE | REPORT | ANALYSIS
id: "unique-kebab-case-id"
created: 2025-11-29
updated: 2025-11-29
agent: cursor
model: gpt-4o
requested_by: user
summary: |
  1-3 sentences describing document purpose.
  AI agents read this first to decide if they need full content.
keywords: [keyword1, keyword2, keyword3]
tags: ["#tag1", "#tag2"]
topics: [topic1, topic2]
related_issues: ["#42"]
project: project-name
module: auth | api | ui | core
language: typescript | python | rust
priority: critical | high | medium | low
status: draft | review | approved | deprecated
confidence: 0.95
token_estimate: 800
complexity: simple | moderate | complex
---
```

**Why?** Enables rapid AI scanning without reading full documents.

## 8. Extended Commits (AI-Context)

Use AI-Context footer for complex decisions:

```text
feat(auth): implement OAuth2 login #42

Adds OAuth2 authentication with Google provider.

AI-Context: architecture | Chose passport.js over custom impl for maintainability
```

## 9. Codex CLI Integration

**Usage modes:**
```bash
codex                      # Interactive mode
codex "explain this code"  # Quick query
codex exec "..."           # Headless automation
```

**Trigger via GitHub:**
- Add label `codex-review` to PR for automated review
- Comment `/codex-review` for on-demand review
- Comment `/codex-analyze` for codebase analysis

## 10. Copilot Coding Agent

**Assign issues to Copilot:**
```bash
gh issue edit <number> --add-assignee "Copilot"
# OR
gh issue edit <number> --add-label "copilot"
```

**Trigger in PRs:**
- Mention `@copilot` in PR comments for specific tasks
- Copilot creates branches named `copilot/*`

**Monitor Copilot work:**
```bash
gh pr list --head "copilot/"
```

## 11. Google Jules Agent

**Assign issues to Jules:**
```bash
# Via GitHub label (requires Jules GitHub App)
gh issue edit <number> --add-label "jules"
```

**Via Jules CLI:**
```bash
jules new "implement feature X"
jules new --repo owner/repo "write unit tests"
jules remote list --session
jules remote pull --session <id> --apply
```

## 12. Agent Load Balancing

**Auto-dispatch to available agents:**
```bash
# Add ai-agent label for automatic distribution
gh issue edit <number> --add-label "ai-agent"

# Or trigger workflow manually
gh workflow run agent-dispatcher.yml
```
